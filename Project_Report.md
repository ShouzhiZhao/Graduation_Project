# 社交网络传播模拟与影响力最大化项目报告

## 1. 项目概览

本项目旨在构建一个高保真的社交网络传播模拟系统，通过 Agent-based Modeling (ABM) 技术复现真实社交网络中的信息传播过程。在此基础上，利用深度生成模型 (Deep Generative Model) 学习传播规律，并提出一种基于梯度的影响力最大化 (Influence Maximization, IM) 求解方法。

项目主要包含三个核心模块：
1.  **仿真代理系统 (Simulation Agent)**: 基于大语言模型 (LLM) 和推荐算法的智能体模拟。
2.  **数据分析与对比 (Data Analysis)**: 验证模拟数据与真实社交媒体数据的统计一致性。
3.  **DeepIM 模型 (Deep Influence Maximization)**: 基于 VAE 和 GraphTransformer 的端到端影响力预测与优化框架。

---

## 2. 数据模拟系统 (Simulation System)

### 2.1 系统架构
模拟系统位于 `simulation_agent/` 目录下，采用多智能体 (Multi-Agent) 架构。
*   **Agent (智能体)**: 主要由 `RecAgent` (推荐智能体) 组成。每个 Agent 拥有独立的属性（年龄、兴趣、性格）、记忆系统 (`GenerativeAgentMemory`) 和社交关系网。
*   **环境 (Environment)**: 模拟了一个包含 1000 个节点的社交网络图结构 (`relationship_1000.csv`)。
*   **交互机制**:
    *   **Post (发布)**: 种子用户 (`init_seed_agents`) 发布关于特定话题（如电影推荐）的内容。
    *   **Observe (观察)**: 邻居节点在其“信息流”中观察到好友的动态。
    *   **React (反应)**: 基于 LLM 和内部状态，Agent 决定是否互动（点赞、评论）或转发，从而形成级联传播。

### 2.2 模拟流程
1.  **初始化**: 加载社交网络结构，初始化 Agent 属性和记忆。
2.  **种子激活**: 选定初始种子用户发布目标信息。
3.  **时间步演化**: 模拟按时间步 (Step/Round) 进行，记录所有交互行为 (`interaction.csv`)。

---

## 3. 真实数据对比分析 (Real Data Comparison)

为了验证模拟系统的逼真度，我们将模拟数据与真实社交媒体数据（以“疯狂动物城2”话题为例）进行了详细对比。

### 3.1 总体指标
| 指标 | 真实数据 (Real) | 模拟数据 (Sim) | 说明 |
| :--- | :--- | :--- | :--- |
| **网络规模** | 412,141 | 1,000 | 模拟为缩微模型 |
| **峰值活跃比** | 10.77% | 6.29% | 爆发强度接近 |
| **增长模式** | S型曲线 | S型曲线 | 演化趋势一致 |

### 3.2 趋势相关性
尽管量级不同，但在归一化后的演化趋势上，模拟数据展现了极高的拟合度：
*   **累计互动量相关性**: **0.9820** (极高一致性)
*   **累计覆盖人数相关性**: **0.9385**
*   **活跃度相关性**: **0.5910**

### 3.3 动力学特性
*   **增长模型**: 真实与模拟数据均最符合 **Gompertz 模型** (非对称生长)，优于 Logistic 模型，反映了社交传播的资源受限特征。
*   **衰减模型**: 均呈现 **幂律衰减 (Power Law)** 特征，而非指数衰减，成功复现了长尾效应。

![拟合曲线](propagation_analysis_result.png)

### 3.4 可视化对比
下图展示了模拟数据与真实数据的传播趋势对比：

![传播数据对比](comparison_full.png)

*(注：上图展示了归一化后的活跃用户数、累计覆盖人数等指标随时间的演化对比)*

---

## 4. 深度影响力最大化模型 (DeepIM)

为了在模拟网络中解决影响力最大化问题，我们提出了 DeepIM 框架。该框架位于 `DeepIM/` 目录下，旨在通过深度学习替代昂贵的蒙特卡洛模拟。

### 4.1 模型架构
DeepIM 包含两个主要组件：

1.  **变分自编码器 (VAE)**:
    *   **Encoder**: 将离散的种子节点集合 (Seed Set, $x$) 映射到连续的低维潜空间 (Latent Space, $z$)。
    *   **Decoder**: 将潜向量 $z$ 重构回种子集合概率分布 $\hat{x}$。
    *   **作用**: 解决离散组合优化难以直接求导的问题，将搜索空间转化为连续空间。

2.  **前向预测模型 (Forward Model)**:
    *   基于 **GraphGPS (General Powerful Scalable Graph Transformers)**。
    *   **架构**: 采用混合架构，结合了 **GCN** (处理局部邻域信息) 和 **Global Attention** (处理全图长距离依赖)，并引入位置编码 (Positional Encoding) 增强结构感知。
    *   **输入**: 种子集合 $\hat{x}$ 和 社交网络邻接矩阵 $A$。
    *   **输出**: 预测最终的传播覆盖范围 $\hat{y}$ (Final Influence)。
    *   **作用**: 快速评估给定种子集的影响力，无需运行耗时的 Agent 模拟。

### 4.2 训练过程 (`train_genim.py`)
*   **数据来源**: 使用 Agent 模拟产生的大量 (种子集, 传播结果) 对数据。
*   **损失函数**:
    $$ \mathcal{L} = \mathcal{L}_{recon}(x, \hat{x}) + \mathcal{L}_{pred}(y, \hat{y}) + \text{KLD}(z) $$
    同时最小化种子重构误差和影响力预测误差。
*   **结果**: Total: 51.4201  Reconstruction Loss: 0.1181     Forward Loss: 51.3020   Precision: 0.9954       Recall: 0.9874

---

## 5. 求解方法 (Optimization Method)

基于训练好的 DeepIM 模型，我们将影响力最大化问题转化为潜空间中的连续优化问题。

### 5.1 优化流程 (`optimize_genim.py`)

1.  **初始化**:
    *   选取数据集中影响力较高的 Top-K 种子集。
    *   通过 Encoder 映射到潜空间，计算平均潜向量 $z_{init}$ 作为起点。

2.  **梯度上升 (Gradient Ascent)**:
    *   目标函数：最大化预测影响力，同时约束种子数量。
    *   $$ \text{Maximize } \hat{y} = \text{ForwardModel}(\text{Decoder}(z), A) $$
    *   $$ \text{Subject to } \sum \text{Decoder}(z) \approx K $$
    *   直接对潜向量 $z$ 进行迭代更新：$z \leftarrow z + \eta \nabla_z \mathcal{L}$。

3.  **生成最终解**:
    *   优化收敛后，使用 Decoder 将最优潜向量 $z^*$ 解码为概率向量。
    *   选取概率最高的 $K$ 个节点作为最终推荐的种子集合。

### 5.2 优势
*   **效率**: 相比传统的贪心算法 (Greedy) 需要数万次蒙特卡洛模拟，DeepIM 只需一次前向传播即可评估影响力。
*   **可微性**: 通过潜空间映射，使得组合优化问题可以使用高效的梯度下降方法求解。

---

## 6. 总结
本项目成功构建了从“微观 Agent 模拟”到“宏观规律发现”再到“策略优化求解”的完整闭环。模拟系统的高保真度为算法研究提供了可靠的数据基础，而 DeepIM 方法则展示了利用深度生成模型解决复杂网络组合优化问题的巨大潜力。
